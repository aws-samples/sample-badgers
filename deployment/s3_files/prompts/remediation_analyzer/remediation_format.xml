<!-- ===================================================================
SECTION 6: OUTPUT SPECIFICATION WITH CHAIN-OF-THOUGHT
=================================================================== -->

<output_specification>
       <format> You MUST provide your analysis FIRST inside &lt;analysis&gt; tags, THEN output the JSON array. No markdown code blocks. No additional explanatory text after the JSON. </format>

       <analysis_requirements>
              <requirement id="1"
                           name="Page Overview"
                           > Describe the overall page layout: - Single column or multi-column? - What major sections or regions exist? - Any headers, footers, or sidebars? - Approximate element count </requirement>

              <requirement id="2"
                           name="Element Inventory"
                           > List all elements you identify, in reading order: - "1. H1 - Document title at top center" - "2. P - Introductory paragraph below title" - "3. Figure - Chart in upper right" - etc. </requirement>

              <requirement id="3"
                           name="Boundary Tracing"
                           > For EACH significant element, trace its boundaries: - TOP edge: what marks it? (first line of text, top of image frame) - BOTTOM edge: what marks it? (last line of text, bottom of image) - LEFT edge: where does content start? - RIGHT edge: where does content end? Map each edge to the grid coordinates. </requirement>

              <requirement id="4"
                           name="Coordinate Assignment"
                           > State the top_left and bottom_right for each element: - "H1: B2 → AE3 (title spans nearly full width, rows 2-3)" - "P: B5 → R15 (left column paragraph)" - "Figure: T5 → AE15 (chart in right column)" </requirement>

              <requirement id="5"
                           name="Validation Checks"
                           > Verify your coordinates: - Elements don't overlap inappropriately - Reading order makes logical sense - Proportions match visual estimates - Headings are assigned correct levels </requirement>
       </analysis_requirements>

       <output_sequence>
              <step order="1">Write your complete analysis inside &lt;analysis&gt;...&lt;/analysis&gt; tags</step>
              <step order="2">Output ONLY the JSON array after the analysis (no markdown, no ```json blocks)</step>
       </output_sequence>

       <schema>
   <![CDATA[
   <analysis>
   [Your detailed reasoning following all 5 analysis requirements]
   </analysis>

   [
     {
       "page_number": "string - Page number if visible, or 'unknown'",
       "order": "integer - Reading order (1-indexed)",
       "type": "string - PDF/UA element type from element_types",
       "content": "string - Text content or description (first 200 chars for long content)",
       "top_left": "string - Cell at upper-left corner (e.g., B2)",
       "bottom_right": "string - Cell at lower-right corner (e.g., AE5)",
       "confidence": "string - high|medium|low",
       "alt_text": "string|null - Alternative text for figures (required for Figure type)",
       "parent_order": "integer|null - Order number of parent element for captions/nested items",
       "heading_level": "integer|null - 1-6 for heading elements",
       "is_artifact": "boolean - true if decorative/non-content element"
     }
   ]
   ]]>
       </schema>

       <field_descriptions>
              <field name="page_number">Page number visible on the page, or "unknown" if not visible</field>
              <field name="order">Sequential number based on reading order, starting at 1</field>
              <field name="type">PDF/UA element type (H1, H2, P, Figure, Table, L, Artifact, etc.)</field>
              <field name="content">The text content, or a brief description for non-text elements</field>
              <field name="top_left">Grid cell at the upper-left corner of the bounding box</field>
              <field name="bottom_right">Grid cell at the lower-right corner of the bounding box</field>
              <field name="confidence">high (clear boundaries), medium (some ambiguity), low (uncertain)</field>
              <field name="alt_text">Descriptive text for figures - REQUIRED for all Figure elements</field>
              <field name="parent_order">For captions, the order number of the figure/table they describe</field>
              <field name="heading_level">1-6 indicating the heading hierarchy level</field>
              <field name="is_artifact">true for non-content elements (page numbers, decorations)</field>
       </field_descriptions>

       <confidence_levels>
              <level value="high">Element is clearly visible, boundaries are unambiguous, type is certain</level>
              <level value="medium">Element is identifiable but some boundaries or classification is unclear</level>
              <level value="low">Element presence or boundaries are uncertain</level>
       </confidence_levels>

       <example description="Simple document page with heading, paragraphs, figure, and page number (36x36 grid)">
   <![CDATA[
   <analysis>
   **1. Page Overview**
   Single-column layout with a document title at the top, followed by two paragraphs of body text. A figure (bar chart) appears in the middle of the page with a caption below it. There's a page number "1" at the bottom center. Approximately 6 elements total.

   **2. Element Inventory**
   1. H1 - Document title "Annual Report 2024" centered at top
   2. P - Introductory paragraph below title
   3. Figure - Bar chart showing quarterly revenue
   4. Caption - "Figure 1: Quarterly Revenue Growth" below the chart
   5. P - Additional paragraph below the caption
   6. Artifact - Page number "1" at bottom center

   **3. Boundary Tracing**
   H1 "Annual Report 2024":
   - TOP: First line of title text → row 3
   - BOTTOM: Single line heading → row 4
   - LEFT: Title starts around column E
   - RIGHT: Title ends around column AB

   P (first paragraph):
   - TOP: First line of paragraph → row 6
   - BOTTOM: Last line of paragraph → row 10
   - LEFT: Left margin → column C
   - RIGHT: Right margin → column AD

   Figure (bar chart):
   - TOP: Top of chart frame → row 12
   - BOTTOM: Bottom of chart including x-axis labels → row 24
   - LEFT: Y-axis labels → column D
   - RIGHT: Right edge of chart → column AC

   Caption:
   - TOP: Caption text → row 25
   - BOTTOM: Single line → row 26
   - LEFT: Centered start → column J
   - RIGHT: Centered end → column W

   P (second paragraph):
   - TOP: First line → row 28
   - BOTTOM: Last line → row 32
   - LEFT: Left margin → column C
   - RIGHT: Right margin → column AD

   Artifact (page number):
   - TOP/BOTTOM: Row 35
   - LEFT/RIGHT: Centered, columns Q-S

   **4. Coordinate Assignment**
   - H1: E3 → AB4
   - P (first): C6 → AD10
   - Figure: D12 → AC24
   - Caption: J25 → W26 (parent: Figure at order 3)
   - P (second): C28 → AD32
   - Artifact: Q35 → S35

   **5. Validation Checks**
   - No overlapping bounding boxes ✓
   - Reading order flows top to bottom ✓
   - Figure ends at row 24 (~67% down page), matches visual ✓
   - Caption correctly linked to Figure via parent_order ✓
   - H1 is appropriate for document title ✓
   </analysis>

   [
     {
       "page_number": "1",
       "order": 1,
       "type": "H1",
       "content": "Annual Report 2024",
       "top_left": "E3",
       "bottom_right": "AB4",
       "confidence": "high",
       "heading_level": 1
     },
     {
       "page_number": "1",
       "order": 2,
       "type": "P",
       "content": "This report summarizes the key achievements and financial performance of our organization during the 2024 fiscal year...",
       "top_left": "C6",
       "bottom_right": "AD10",
       "confidence": "high"
     },
     {
       "page_number": "1",
       "order": 3,
       "type": "Figure",
       "content": "Bar chart showing quarterly revenue",
       "top_left": "D12",
       "bottom_right": "AC24",
       "confidence": "high",
       "alt_text": "Bar chart displaying quarterly revenue for 2024: Q1 $2.1M, Q2 $2.4M, Q3 $2.8M, Q4 $3.2M, showing consistent growth throughout the year"
     },
     {
       "page_number": "1",
       "order": 4,
       "type": "Caption",
       "content": "Figure 1: Quarterly Revenue Growth",
       "top_left": "J25",
       "bottom_right": "W26",
       "confidence": "high",
       "parent_order": 3
     },
     {
       "page_number": "1",
       "order": 5,
       "type": "P",
       "content": "As shown in Figure 1, revenue increased steadily across all quarters, with Q4 representing our strongest performance...",
       "top_left": "C28",
       "bottom_right": "AD32",
       "confidence": "high"
     },
     {
       "page_number": "1",
       "order": 6,
       "type": "Artifact",
       "content": "1",
       "top_left": "Q35",
       "bottom_right": "S35",
       "confidence": "high",
       "is_artifact": true
     }
   ]
   ]]>
       </example>
</output_specification>